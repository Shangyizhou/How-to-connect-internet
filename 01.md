## 浏览器生成消息

**需要解决的问题**

- 我们想浏览器中输入网址，浏览器会工作对网址进行解析并生成请求消息。我们需要知道浏览器是如何解析网址的，并得知请求消息报文的样子。
- 请求消息生成后，浏览器会委托操作系统向Web服务器发送请求，那么我们的浏览器需要告诉OS接收方的IP地址是多少，因此我们需要得知浏览器是如何得知Web服务器的IP地址的。即，DNS服务器是如何查询IP地址的。
- 我们将会对DNS服务器进行进一步的理解，上万台的DNS服务器是如何接力才能查询到IP地址的
- 查询完成后，浏览器是如何委托OS将消息报文发送给服务器的，这个委托是如何完成的。

### 生成HTTP请求消息

#### 输入网址

我们输入的网址，比如`http://...`这一串，我们叫做`URL(Uniform Resource Locator，统一资源定位符)`

但实际上除了`“http:”`，网址还可以以其他一些文字开头，例如`“ftp:”“file:” “mailto:”C` 等。 之所以有各种各样的 URL，是因为尽管我们通常是使用浏览器来访问 Web 服务器的，但实际上浏览器并不只有这一个功能，它也可以用来在 FTP服务器上下载和上传文件，同时也具备电子邮件客户端的功能。**可以说，浏览器是一个具备多种客户端功能的综合性客户端软件**，因此它需要 一些东西来判断应该使用其中哪种功能来访问相应的数据，比如访问 Web 服务器时用`“http:”`，而访问 FTP 服务器时用`“ftp:”`

<img src="https://syz-picture.oss-cn-shenzhen.aliyuncs.com/image-20211117163521479.png" alt="image-20211117163521479" style="zoom: 80%;" />

```C
http://glasscom.com/dir/file1.htm
```

#### 浏览器解析URL

![image-20211117163756704](https://syz-picture.oss-cn-shenzhen.aliyuncs.com/image-20211117163756704.png)

![image-20211117163800318](https://syz-picture.oss-cn-shenzhen.aliyuncs.com/image-20211117163800318.png)

#### HTTP的基本思路

解析完 URL 之后，我们就知道应该要访问的目标在哪里了。接下来， 浏览器会使用 HTTP 协议来访问 Web 服务器，我们需要先介绍一下HTTP协议

![image-20211117163951600](https://syz-picture.oss-cn-shenzhen.aliyuncs.com/image-20211117163951600.png)

首先，客户端会向服务器发送请求消息。**请求消息中包含的内容是“对什么(URI)”和“进行怎样的操作(方法)”两个部分。**一般来说，URI 的内容是一个存放网页数据的文件名或者是一个 CGI 程序的文件名，例如`“/dir1/file1.html”` `“/dir1/program1.cgi”`等 。不过，URI 不仅限于此，也可以直接使用`“http:” `开头的 URL来作为 URI。换句话说就是，这里可以写各种访问目标，而这些访问目标统称为 URI。 

方法表示需要让 Web 服务器完成怎样的工作，其中典型的例子包括读取 URI 表示的数据、 将客户端输入的数据发送给 URI 表示的程序等。表 1.1 列举了主要的方法， 通过这张表大家应该能够理解通过方法可以执行怎样的操作。

<img src="https://syz-picture.oss-cn-shenzhen.aliyuncs.com/image-20211117164314068.png" alt="image-20211117164314068" style="zoom:80%;" />

> URI表示访问目标
>
> 方法表示让 Web 服务器完成怎样的工作

#### Web服务器收到请求消息后的处理

收到请求消息之后，Web 服务器会对其中的内容进行解析，通过 URI 和方法来判断“对什么”“进行怎样的操作”，并根据这些要求来完成自己的工作，然后将结果存放在响应消息中。在响应消息的开头有一个状态码， 它用来表示操作的执行结果是成功还是发生了错误。

响应消息会被发送回客户端，客户端收到之后，浏览器会从消息中读出所需的数据并显示在屏幕上。到这里，HTTP 的整个工作就完成了。

